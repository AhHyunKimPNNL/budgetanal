
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="../../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.3, mkdocs-material-8.1.4" name="generator"/>
<title>Atmospheric Model - Budget Analysis</title>
<link href="../../assets/stylesheets/main.bb3983ee.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.e6a45f82.min.css" rel="stylesheet"/>
<meta content="#009485" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="" data-md-color-primary="teal" data-md-color-scheme="" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#personal-notes">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Budget Analysis" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Budget Analysis">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Budget Analysis
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Atmospheric Model
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../01_basic_simulation/">
        Base Simulation
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../02_zm_rad_modification/">
        New Simulation
      </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../appendix/">
      Appendix
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../">
        Ah-Hyun
      </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Budget Analysis" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Budget Analysis">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"></path></svg>
</a>
    Budget Analysis
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../01_basic_simulation/">Base Simulation</a>
<label for="__nav_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Base Simulation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Base Simulation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../01_basic_simulation/01_global/">01 Global</a>
<label for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="01 Global" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          01 Global
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/01_global/01_by_chkpt/">
        By Check Point
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/01_global/02_by_variable/">
        By Variables
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_2_3" id="__nav_2_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../01_basic_simulation/02_cloud_regime/">02 Cloud regime</a>
<label for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="02 Cloud regime" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
          02 Cloud regime
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/02_cloud_regime/01_ITCZ/">
        ITCZ
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/02_cloud_regime/02_Storm_track/">
        Storm Track
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/02_cloud_regime/03_Stratocumulus/">
        Stratocumulus
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/02_cloud_regime/04_by_chkpt/">
        By Check Point
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../01_basic_simulation/02_cloud_regime/05_by_variable/">
        By Variables
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../../02_zm_rad_modification/">New Simulation</a>
<label for="__nav_3">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="New Simulation" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          New Simulation
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../02_zm_rad_modification/01_global/">
        Global
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../02_zm_rad_modification/02_cloud_regime/">
        Cloud Regime
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../appendix/">
        Appendix
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../">Ah-Hyun</a>
<label for="__nav_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="Ah-Hyun" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Ah-Hyun
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../01_workflow/">
        Summary
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Atmospheric Model
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Atmospheric Model
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#dynamics-physics-coupling">
    Dynamics &amp; Physics coupling??
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#coupling-of-dynamical-core-and-parameterization-suite-in-cam5">
    Coupling of Dynamical Core and Parameterization Suite in CAM5
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#horizontal-discretization">
    Horizontal discretization
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#spectral-element-dynamical-core">
    Spectral-element dynamical core
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#dyanmical-core-clipping">
    Dyanmical core clipping?
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#deep-convection">
    Deep Convection
  </a>
<nav aria-label="Deep Convection" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#dilution">
    dilution
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../03_code/">
        codes
      </a>
</li>
<li class="md-nav__item md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_5_5" id="__nav_5_5" type="checkbox"/>
<div class="md-nav__link md-nav__link--index">
<a href="../05_references/">References</a>
<label for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-label="References" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_5">
<span class="md-nav__icon md-icon"></span>
          References
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_5_5_2" id="__nav_5_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_5_2">
          E3SM
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="E3SM" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_5_2">
<span class="md-nav__icon md-icon"></span>
          E3SM
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../05_references/Rasch_et_al_2019_JAMES/">
        Rasch et al.(2019,JAMES)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05_references/Xie_et_al_2018_JAMES/">
        Xie et al.(2018,JAMES)
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_5_5_3" id="__nav_5_5_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_5_3">
          Process Coupling
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Process Coupling" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_5_3">
<span class="md-nav__icon md-icon"></span>
          Process Coupling
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../05_references/Lauritzen_and_Williamson_2019_JAMES/">
        Lauritzen and Williamson(2019,JAMES)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05_references/Wan_et_al_2020_JAMES/">
        Wan et al.(2020,JAMES)
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../05_references/Zhang_et_al_2018_GMD/">
        Zhang et al.(2018,GMD)
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-state="indeterminate" data-md-toggle="__nav_5_5_4" id="__nav_5_5_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_5_4">
          Stratocumulus
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Stratocumulus" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_5_4">
<span class="md-nav__icon md-icon"></span>
          Stratocumulus
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../05_references/Medeiros_et_al_2012_JC/">
        Medeiros et al. (2012,JC)
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="personal-notes">Personal notes</h1>
<h2 id="dynamics-physics-coupling">Dynamics &amp; Physics coupling??</h2>
<p><a href="https://www.ecmwf.int/sites/default/files/elibrary/2004/8032-numerics-physical-parameterization.pdf">The numerics of physical parametrization</a></p>
<h2 id="coupling-of-dynamical-core-and-parameterization-suite-in-cam5">Coupling of Dynamical Core and Parameterization Suite in CAM5</h2>
<p><a href="https://ncar.github.io/CAM/doc/build/html/cam5_scientific_guide/pd_coupling.html">Link for the documentation</a></p>
<p><ins>The CAM5.0 cleanly separates the parameterization suite from the dynamical core</ins>, and makes it easier to replace or modify each in isolation. The dynamical core can be coupled to the parameterization suite in a purely time split manner or in a purely process split one, as described below.</p>
<p>Consider the general prediction equation for a generic variable <span class="arithmatex">\(\psi\)</span>,</p>
<p>(1) <span class="arithmatex">\(\frac{\partial \psi} {\partial t}\)</span> = <span class="arithmatex">\(D\left(\psi\right)\)</span>  + <span class="arithmatex">\(P\left(\psi\right)\)</span> ;,</p>
<ul>
<li><span class="arithmatex">\(\psi\)</span>: a prognostic variable (e.g., temperature, horizontal wind component)</li>
<li>D: The dynamical core component</li>
<li>P: the physical parameterization suite</li>
</ul>
<p>A three-time-level notation is employed which is appropriate for the semi-implicit Eulerian spectral transform dynamical core. However, the numerical characteristics of the physical parameterizations are more like those of diffusive processes rather than advective ones. They are therefore approximated with forward or backward differences, rather than centered three-time-level forms.</p>
<p><mark class="critic">The Process Split coupling</mark> is approximated by</p>
<p>(2) <span class="arithmatex">\(\psi^{n+1}\)</span> = <span class="arithmatex">\(\psi^{n-1} + 2\Delta t D(\psi^{n+1},\psi^{n},\psi^{n-1})
                        + 2\Delta t P(\psi^*,\psi^{n-1}) \;,\)</span></p>
<p>where <span class="arithmatex">\(P(\psi^*,\psi^{n-1})\)</span> is calculated first from</p>
<p>(3)<span class="arithmatex">\(\psi^* = \psi^{n-1} + 2\Delta t P(\psi^*,\psi^{n-1}) \;.\)</span></p>
<p><mark class="critic">The Time Split coupling</mark> is approximated by</p>
<p>(4)<span class="arithmatex">\(\psi^* = \psi^{n-1} + 2\Delta t D(\psi^*,\psi^{n},\psi^{n-1}) \;,\)</span></p>
<p>(5)<span class="arithmatex">\(\psi^{n+1} = \psi^* + 2\Delta t P(\psi^{n+1},\psi^*) \;\)</span>.</p>
<p>The distinction is that in the Process Split approximation the calculations of D and P are both based on the same past state, <span class="arithmatex">\(\psi^{n-1}\)</span>, <ins>while in the Time Split approximations D and P are calculated sequentially</ins>, each based on the state produced by the other.</p>
<p>As mentioned above, the Eulerian core employs the three-time-level notation in eq. (2)-(5). Eqns. (2)-(5) also apply to two-time-level finite volume, semi-Lagrangian and spectral element (HOMME) cores by dropping centered n term dependencies, and replacing n-1 by n and <span class="arithmatex">\(2 \Delta t\)</span> by <span class="arithmatex">\(\Delta t\)</span>.</p>
<p>The parameterization package can be applied to produce an updated field as indicated in Eq. (3) and Eq. (5). Thus Eq. (5) can be written with an operator notation</p>
<p>(6)<span class="arithmatex">\(\psi^{n+1} = {\boldsymbol{P}}\left(\psi^*\right) \;\)</span>,</p>
<p>where only the past state is included in the operator dependency for notational convenience. The implicit predicted state dependency is understood. The Process Split equation (2) can also be written in operator notation as</p>
<p>(7)<span class="arithmatex">\(\psi^{n+1} = {\boldsymbol{D}}\left(\psi^{n-1},
      \frac {{\boldsymbol{P}}(\psi^{n-1})-\psi^{n-1}} {2 \Delta t} \right) \;\)</span>,</p>
<ul>
<li><span class="arithmatex">\(\psi^{n-1}\)</span>: the prognostic variable input to the dynamical core</li>
<li><span class="arithmatex">\(\frac {{\boldsymbol{P}}(\psi^{n-1})-\psi^{n-1}} {2 \Delta t} ;\)</span>: the forcing rate from the parameterization package (e.g. the heating rate in the thermodynamic equation). </li>
</ul>
<p>Again only the past state is included in the operator dependency, with the implicit predicted state dependency left understood. With this notation the Time Split system (4) and (5) can be written</p>
<p>(8)<span class="arithmatex">\(\psi^{n+1} = {\boldsymbol{P}}\left({\boldsymbol{D}}\left(\psi^{n-1},0\right)\right) \;\)</span>.</p>
<p>The total parameterization package in CAM5.0 consists of a sequence of components, indicated by</p>
<p>(9)<span class="arithmatex">\(P = \{ M,R,S,T \} \;\)</span>,</p>
<ul>
<li>M: (Moist) precipitation processes</li>
<li>R: clouds and Radiation</li>
<li>S: the Surface model</li>
<li>T: Turbulent mixing. </li>
</ul>
<p>Each of these in turn is subdivided into various components: M includes an optional dry adiabatic adjustment (normally applied only in the stratosphere), moist penetrative convection, shallow convection, and large-scale stable condensation; R first calculates the cloud parameterization followed by the radiation parameterization; S provides the surface fluxes obtained from land, ocean and sea ice models, or calculates them based on specified surface conditions such as sea surface temperatures and sea ice distribution. These surface fluxes provide lower flux boundary conditions for the turbulent mixing T which is comprised of the planetary boundary layer parameterization, vertical diffusion, and gravity wave drag.</p>
<p>Defining operators following (6) for each of the parameterization components, the couplings in CAM5.0 are summarized as:</p>
<p>TIME SPLIT</p>
<p>(10)<span class="arithmatex">\(\psi^{n+1} = {\boldsymbol{T}}\left({\boldsymbol{S}}\left({\boldsymbol{R}}\left({\boldsymbol{M}}\left(
             {\boldsymbol{D}}\left(\psi^{n-1},0\right)\right)\right)\right)\right)\)</span></p>
<p>PROCESS SPLIT</p>
<p>(11)<span class="arithmatex">\(\psi^{n+1} = {\boldsymbol{D}}\left(\psi^{n-1},\frac {
{\boldsymbol{T}}\left({\boldsymbol{S}}\left({\boldsymbol{R}}\left(
{\boldsymbol{M}}\left(\psi^{n-1}\right)\right)\right)\right) - \psi^{n-1}}
{2\Delta t}\right)\)</span></p>
<p>The labels Time Split and Process Split refer to the coupling of the dynamical core with the complete parameterization suite. The components within the parameterization suite are coupled via time splitting in both forms.</p>
<p>The Process Split form is convenient for spectral transform models. With Time Split approximations extra spectral transforms are required to convert the updated momentum variables provided by the parameterizations to vorticity and divergence for the Eulerian spectral core, or to recalculate the temperature gradient for the semi-Lagrangian spectral core. The Time Split form is convenient for the finite-volume core which adopts a Lagrangian vertical coordinate. Since the scheme is explicit and restricted to small time-steps by its non-advective component, it sub-steps the dynamics multiple times during a longer parameterization time step. With Process Split approximations the forcing terms must be interpolated to an evolving Lagrangian vertical coordinate every sub-step of the dynamical core. Besides the expense involved, it is not completely obvious how to interpolate the parameterized forcing, which can have a vertical grid scale component arising from vertical grid scale clouds, to a different vertical grid. [Wil02] compares simulations with the Eulerian spectral transform dynamical core coupled to the CCM3 parameterization suite via Process Split and Time Split approximations.</p>
<p>[Wil02] D. L. Williamson. Time-split versus process-split coupling of parameterizations and dynamical core. Mon. Wea. Rev., 130:2024–2041, 2002.</p>
<h2 id="horizontal-discretization">Horizontal discretization</h2>
<p><img alt="Horizontal discretization" src="https://agupubs.onlinelibrary.wiley.com/cms/asset/bf1ead11-db1c-46b1-bcfd-67804109d477/jame20932-fig-0001-m.png"/></p>
<h2 id="spectral-element-dynamical-core">Spectral-element dynamical core</h2>
<p>TBC</p>
<h2 id="dyanmical-core-clipping">Dyanmical core clipping?</h2>
<p>In E3SM, <a href="https://github.com/E3SM-Project/E3SM/blob/master/components/eam/src/physics/cam/clubb_intr.F90#L1804">clipping was mentioned in clubb_intr.F90</a></p>
<div class="admonition note">
<p>An example of an inconsistency in CAM physics is that surface pressure is held fixed during physical parameterization updates, but water vapor, and hence surface pressure, does change during evaporation/precipitation and an inconsistency appears in the mass and energy budget. Similarly, if a “<mark class="critic">clipper</mark>” is used on water vapor or condensates to avoid (unphysical) negative mixing ratios (more details in section 3.2) and this is not accounted for in the thermodynamics or through a surface flux, that “<mark class="critic">clipping</mark>” will produce an energy source via the mass weightening in the TE vertical integral. In the dynamical core TE is not conserved locally in each column as there is a horizontal flux of energy between columns; but the local energy budget should, ideally, be closed and thereby, globally, TE should be conserved. If a dynamical core does not inherently conserve dry air mass and/or water mass then a spurious source of TE is inevitable again through the mass weightening in the vertical integral (unless fixers are applied). (Lauritzen et al., 2019)</p>
</div>
<details class="note" open="open">
<summary>References</summary>
<ul>
<li>Lauritzen, P. H., &amp; Williamson, D. L. (2019). A total energy error analysis of dynamical cores and physics-dynamics coupling in the Community Atmosphere Model (CAM). Journal of Advances in Modeling Earth Systems, 11, 1309–1328. https://doi.org/10.1029/2018MS001549</li>
</ul>
</details>
<h2 id="deep-convection">Deep Convection</h2>
<h3 id="dilution">dilution</h3>
<p><a href="https://doi.org/10.1175/JAS-D-16-0169.1">see Hannah 2017</a></p>
<p>Dilution of a given tracer is defined here as a proportional rate of change of the mass-weighted average tracer concentration over a volume of interest. Using a proportional rate of change allows the dilution to reflect the properties of the volume being diluted, in addition to the intensity of the process responsible for the dilution (i.e., entrainment).</p>
<p><a href="https://doi.org/10.1029/2020MS002365">see Zhang et al. 2021</a>
CAPE-based triggers are commonly used in deep convection schemes such as the ZM scheme, which is one of the common deep convection schemes used in several climate models including the NCAR CAM and the Department of Energy E3SM Atmosphere Model (EAM). </p>
<p><mark class="critic">undiluted CAPE</mark> is defined as the vertical integral of the local buoyancy of a parcel from the launch level to the equilibrium level.</p>
<p>By construction, the undilute CAPE trigger scheme prevents the accumulation of instability in the atmosphere beyond the threshold value and results in generally triggering convection too frequently and too early during the day (e.g., Xie &amp; Zhang, 2000).</p>
<p>Neale et al. (2008) introduced the <ins>dilution effect of entrained air</ins> into the CAPE calculation (hereafter called <mark class="critic">dilute</mark> CAPE). </p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Summary" class="md-footer__link md-footer__link--prev" href="../01_workflow/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Summary
            </div>
</div>
</a>
<a aria-label="Next: codes" class="md-footer__link md-footer__link--next" href="../03_code/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              codes
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.tabs", "navigation.sections", "navigation.expand", "navigation.indexes", "toc.integrate", "content.tabs.link"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../assets/javascripts/workers/search.361d90f1.min.js"}</script>
<script src="../../assets/javascripts/bundle.289a2a4b.min.js"></script>
<script src="../../javascripts/mathjax.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>